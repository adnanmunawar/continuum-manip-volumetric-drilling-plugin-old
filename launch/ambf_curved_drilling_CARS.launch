<?xml version="1.0"?>
<launch>
    <arg name="config_dir" default="/config/sim_ur5/"/>
    <arg name="path_to_main_dir" default="$(find spine_robot_control)"/>
    <arg name="constraint_config"/>
    <arg name="trace_path"/>
    <arg name="verbosity" default="INFO"/>

    <include file="$(find continuum_manip_volumetric_drilling_plugin)/launch/run_cm_vol_drill_simul.launch">
        <arg name="ambf_args" value=" \
          -l 11,15,25,29,30 \
          --anatomy_volume_name spine_seg \
          --debug_traj_file $(arg trace_path) \
          --name_body_to_trace Burr \
          --csv_filename_static_traces $(arg trace_path) \
          --static_trace_rel_body_name spine_seg \
          --experimental_behavior 1"/>
    </include>

    <node pkg="continuum_manip_volumetric_drilling_plugin" name="ambf_ros_ur5" type="ur5_ambf.py" output="screen"/> 

    <node pkg="continuum_manip_volumetric_drilling_plugin" name="xreg_imager" type="start_xreg_imager_from_roslaunch.sh"
        args="/home/$(env USER)/snake_registration/simulation/JustinSnakeModel_huatt/ /home/$(env USER)/snake_registration/simulation/output/ /home/$(env USER)/snake_registration/simulation/anatomy/"
        output="screen"/>


    <include file="$(find snake_estimator)/launch/snake_estimator_kalman.launch">
        <arg name="l_to_pose_cal_filename" value="$(arg path_to_main_dir)$(arg config_dir)freespace_cal_l_to_x.txt"/>
        <arg name="th_to_jac_cal_filename" value="$(arg path_to_main_dir)$(arg config_dir)freespace_cal_th_to_dx.txt"/>
        <arg name="cal_units_to_m" value="1.0"/>
        <arg name="verbosity" value="$(arg verbosity)"/>
        <!-- <arg name="rate" value="1000"/> -->
    </include>

    <node pkg="spine_robot_control" type="AMBFURWithSnake" name="AMBFURWithSnake" output="screen" args=
        "-c $(arg config_dir) 
        -m $(arg path_to_main_dir)
        -x $(arg constraint_config)"/>

  <node pkg="rqt_image_view" type="rqt_image_view" name="image_view" args="/snake_imager/image"/>

</launch>